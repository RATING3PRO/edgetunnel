# Cloudflare IP优选器 - 独立版本使用说明

## 概述

本版本是Cloudflare IP优选器的独立GUI版本，已打包为单个exe文件，无需安装Python环境即可直接运行。

## 文件说明

- `CloudflareIPOptimizer.exe` - 独立可执行文件（约9.5MB）
- `ip_optimizer_standalone.py` - 源代码文件
- `build_standalone.py` - 打包脚本
- `requirements_standalone.txt` - 依赖包列表

## 使用方法

### 1. 运行程序

直接双击 `dist/CloudflareIPOptimizer.exe` 即可启动程序。

### 2. 配置设置

首次使用需要点击"配置设置"按钮，填入以下信息：

- **Worker URL**: 您的Cloudflare Worker部署地址
- **API Key**: 在Worker环境变量中设置的API密钥
- **超时时间**: 单次IP测试的超时时间（默认3秒）
- **最大并发数**: 同时测试的IP数量（默认50）
- **测试次数**: 每个IP的测试次数（默认3次）
- **保存IP数量**: 保存到KV的最优IP数量（默认16个）

### 3. 选择测试参数

- **测试端口**: 选择要测试的端口（443、80、2053等）
- **IP来源**: 选择IP数据源
  - Cloudflare官方
  - CM Liu维护
  - ASN 13335
  - ASN 209242
  - 反代IP列表
  - 自定义IP（需导入IP文件）
- **操作模式**: 
  - 替换模式：清空现有IP后添加新的优选IP
  - 追加模式：在现有IP基础上追加新的优选IP

### 4. 开始优选

点击"开始优选"按钮，程序将：
1. 获取IP列表
2. 并发测试IP延迟
3. 筛选最优IP
4. 上传结果到KV空间

### 5. 查看结果

运行过程中可以在日志窗口查看详细信息，包括：
- 获取到的IP数量
- 测试进度
- 最优IP列表
- 上传结果

## 特点优势

### 独立运行
- 单个exe文件，无需安装Python环境
- 内置所有依赖，开箱即用
- 文件大小仅约9.5MB

### 内置配置
- 程序内设置参数，无需外部配置文件
- 配置界面友好，参数说明清晰
- 支持配置保存和修改

### 功能完整
- 支持多种IP数据源
- 支持自定义IP导入
- 支持多端口测试
- 支持替换/追加模式
- 实时日志显示

### 操作简便
- 图形化界面，操作直观
- 一键开始/停止优选
- 进度显示和状态提示
- 支持中途取消操作

## 注意事项

1. **网络环境**: 建议在原生网络环境下运行，避免使用代理或VPN
2. **防火墙**: 确保程序可以访问网络，可能需要添加防火墙例外
3. **配置要求**: 必须先配置Worker URL和API Key才能使用
4. **KV空间**: 确保Worker已正确绑定KV命名空间
5. **自定义域名**: 建议使用自定义域名避免网络阻断问题

## 故障排除

### 程序无法启动
- 检查是否被杀毒软件拦截
- 尝试以管理员身份运行
- 检查系统是否支持（Windows 7+）

### 配置错误
- 确认Worker URL格式正确（如：https://your-worker.your-domain.com）
- 确认API Key与Worker环境变量中设置的一致
- 检查网络连接是否正常

### 测试失败
- 检查选择的IP来源是否可访问
- 尝试降低并发数和增加超时时间
- 确认防火墙未阻止程序网络访问

### 上传失败
- 检查Worker部署是否正常
- 确认KV命名空间绑定正确
- 检查API Key权限设置

## 技术支持

如遇到问题，请检查：
1. 程序日志窗口的错误信息
2. Worker的运行日志
3. 网络连接状态
4. 配置参数是否正确

---

**版本**: v2.0 独立版  
**更新时间**: 2024年  
**适用系统**: Windows 7/8/10/11